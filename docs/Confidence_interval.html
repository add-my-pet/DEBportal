<!DOCTYPE html>
<HTML>
<HEAD>
  <TITLE>Confidence_interval</TITLE>
  <link rel="stylesheet" type="text/css" href="https://www.bio.vu.nl/thb/deb/deblab/add_my_pet/sys/style.css"> 
  <script src="https://www.bio.vu.nl/thb/deb/deblab/add_my_pet/sys/dropdown.js"></script>
  <script src="https://www.bio.vu.nl/thb/deb/deblab/add_my_pet/sys/w3data.js"></script>
</HEAD>
<BODY>

  <div w3-include-html="wallpaper_DEBportal.html"></div>
  <script>w3IncludeHTML();</script>

  <div w3-include-html="toolbar_DEBportal.html"></div>
  <script>w3IncludeHTML();</script>

<div id = "main">
  <div id = "main-wrapper">    
    <div id="contentFull">

    <h1>
      Confidence intervals of DEB parameters
      <a href="https://youtu.be/hIJtytohzIs" target="_blank"><img src="img/YouTube.png"  height = "50px" align="right" title="10:22"></a>
    </h1>

    The method for obtaining parameter confidence intervals is a two-step procedure.
    Steps can be performed in any order, but both steps are required for a final result.
    In the first step, the profile of the loss function for a parameter is obtained.
    In the second, which is the calibration step, the level of the loss function that corresponds to uncertainty is computed.
    Finally, the confidence interval is computed and the profile of the loss function and survival function are plotted.

    <p>
      In your working directory you need to have the 3 user-defined files of your species
      mydata_my_pet.m, predict_my_pet.m, and pars_init_my_pet.m (with the best estimates) + run_CI located in debtool_M/lib/pet_ci/.

    <p>
      Function run_ci performs the following steps:
      <ol>
        <li>Calibration step for the interval estimation
	  <ul>
            <li>calls get_lf_distribution
            <li>saves output to calibrate.mat
	  </ul>
	  
        <li>Calculates the profile of the loss function for a parameter
           <ul>
             <li>calls get_profile
             <li>saves output to profile_nameOFparameter (e.g., profile_v)
	   </ul>
	   

        <li>Plots the profile of the loss function for a parameter
	  <ul>
            <li>Plots the distribution function of the loss function of Monte Carlo simulations
            <li>Gives the marginal confidence interval of the parameter
	  </ul>
      </ol>
      

      In run.ci the user must specify: species name (line 37);
      name of the parameter for which the profile will be calculated, the lower and upper limits of the range of simulations (lines 40-42);
      the confidence level (line 50).

      <p>
        The user can choose the step(s) to simulate (line58) by setting stepCI the value 0, 1, 2, or 3:
	<ul>
          <li>0: runs the whole procedure; 
          <li>1: runs only the calibration step
          <li>2: runs only the profile for a parameter step
          <li>3: computes the CI and graphs the profile (calibrate.mat and profile_*.mat are required)
        </ul>
    
    </div> <!-- end of content -->
 
    <div w3-include-html="footer_amp.html"></div>
    <script>w3IncludeHTML();</script>

  </div> <!-- end of main wrapper -->
</div> <!-- end of main -->
</BODY>
</HTML>
